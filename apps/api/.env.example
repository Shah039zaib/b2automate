# ============================================
# B2Automate API Service - Environment Variables
# ============================================

# NODE ENVIRONMENT
NODE_ENV=production
PORT=3000
LOG_LEVEL=info

# ============================================
# DATABASE (Supabase / PostgreSQL)
# ============================================
# Use Supavisor pooler for production (supports IPv4)
# Get these from: Supabase Dashboard → Project Settings → Database → Connection Pooling

# Transaction pooler (port 6543) - for API queries
DATABASE_URL=postgresql://postgres.PROJECT_REF:PASSWORD@aws-0-REGION.pooler.supabase.com:6543/postgres?pgbouncer=true&connection_limit=1

# Direct connection (port 5432) - for migrations only
DIRECT_URL=postgresql://postgres.PROJECT_REF:PASSWORD@aws-0-REGION.pooler.supabase.com:5432/postgres

# ============================================
# REDIS
# ============================================
REDIS_URL=redis://localhost:6379
REDIS_PASSWORD=

# Advanced Redis Configuration (Optional)
# REDIS_MODE=standalone                    # Options: standalone, sentinel, cluster
# REDIS_SENTINEL_HOSTS=host1:26379,host2:26379
# REDIS_SENTINEL_NAME=mymaster
# REDIS_CLUSTER_NODES=host1:6379,host2:6379

# ============================================
# JWT AUTHENTICATION
# ============================================
# CRITICAL: Change this to a strong random string (min 32 characters)
JWT_SECRET=change-this-to-a-secure-random-string-min-32-chars

# Token expiration times
JWT_ACCESS_EXPIRY=15m                    # Access token: 15 minutes
JWT_REFRESH_EXPIRY=7d                    # Refresh token: 7 days

# ============================================
# AI CONFIGURATION
# ============================================
# AI Provider: openai, openrouter, or anthropic
AI_PROVIDER=openrouter

# OpenAI Configuration
OPENAI_API_KEY=

# OpenRouter Configuration (recommended for cost-effective AI)
OPENROUTER_API_KEY=sk-or-v1-your-api-key-here
OPENROUTER_MODEL=google/gemini-2.0-flash-exp:free

# Anthropic Configuration
ANTHROPIC_API_KEY=

# ============================================
# STRIPE PAYMENT GATEWAY
# ============================================
STRIPE_SECRET_KEY=sk_test_your_stripe_secret_key
STRIPE_WEBHOOK_SECRET=whsec_your_webhook_signing_secret

# ============================================
# FRONTEND URLs
# ============================================
# Main web application URL (for redirects, emails, CORS)
WEB_APP_URL=http://localhost:5173

# Admin panel URL (for super admin redirects)
ADMIN_APP_URL=http://localhost:5174

# Frontend API URL (used by email templates for links)
FRONTEND_URL=http://localhost:5173

# ============================================
# WHATSAPP RATE LIMITS
# ============================================
# Per-customer rate limiting to prevent spam/bans
WHATSAPP_MESSAGE_RATE_LIMIT=5           # Messages per second (global)
WHATSAPP_CUSTOMER_RATE_LIMIT=10         # Messages per customer
WHATSAPP_CUSTOMER_RATE_WINDOW=60        # Time window in seconds

# ============================================
# EMAIL SERVICE (Optional - Skeleton Implementation)
# ============================================
# Email provider: smtp, sendgrid, ses
EMAIL_PROVIDER=smtp

# SMTP Configuration
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your-app-password

# SendGrid Configuration
SENDGRID_API_KEY=

# AWS SES Configuration
AWS_SES_REGION=us-east-1
AWS_SES_ACCESS_KEY_ID=
AWS_SES_SECRET_ACCESS_KEY=

# ============================================
# MEDIA STORAGE (Optional - Skeleton Implementation)
# ============================================
MEDIA_BUCKET_NAME=whatsapp-media
MEDIA_STORAGE_PROVIDER=s3              # Options: s3, gcs, azure, local

# AWS S3 Configuration
AWS_S3_REGION=us-east-1
AWS_S3_ACCESS_KEY_ID=
AWS_S3_SECRET_ACCESS_KEY=

# Google Cloud Storage Configuration
GCP_PROJECT_ID=
GCP_STORAGE_BUCKET=

# Azure Blob Storage Configuration
AZURE_STORAGE_ACCOUNT=
AZURE_STORAGE_KEY=
AZURE_STORAGE_CONTAINER=

# ============================================
# AUDIT LOG RETENTION
# ============================================
AUDIT_LOG_RETENTION_DAYS=90            # Days to keep audit logs before archival

# ============================================
# SECRETS MANAGEMENT (Optional - V2 Feature)
# ============================================
SECRETS_PROVIDER=env                   # Options: env, vault, aws, gcp

# HashiCorp Vault
VAULT_ADDR=http://vault:8200
VAULT_TOKEN=
VAULT_SECRET_PATH=secret/data/b2automate

# AWS Secrets Manager
AWS_REGION=us-east-1
AWS_SECRET_ARN=

# Google Cloud Secret Manager
GCP_PROJECT_ID=

# ============================================
# DISTRIBUTED TRACING (Optional - V2 Feature)
# ============================================
TRACING_ENABLED=false
TRACING_PROVIDER=console               # Options: console, otel

# OpenTelemetry Configuration
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4318

# ============================================
# CORS CONFIGURATION
# ============================================
# Allowed origins for CORS (comma-separated)
CORS_ORIGINS=http://localhost:5173,http://localhost:5174
