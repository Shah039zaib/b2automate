# ============================================
# B2Automate Environment Variables
# ============================================
# Copy this file to .env and fill in values
# NEVER commit .env to version control
# ============================================

# ============================================
# DATABASE (Supabase PostgreSQL)
# ============================================
# Get these from: Supabase Dashboard → Settings → Database
# For local: Use Docker PostgreSQL

# Connection with connection pooler (for runtime - port 6543)
# IMPORTANT: Must use pgbouncer=true for pooler mode
DATABASE_URL="postgresql://postgres.[project-ref]:[password]@aws-0-[region].pooler.supabase.com:6543/postgres?pgbouncer=true&connection_limit=1"

# Direct connection (for Prisma migrations)
DIRECT_URL="postgresql://postgres.[project-ref]:[password]@aws-0-[region].pooler.supabase.com:5432/postgres"

# ============================================
# REDIS (Session Storage & BullMQ Queues)
# ============================================
# For local: redis://localhost:6379
# For production: Use Redis Cloud or Upstash
REDIS_URL="redis://localhost:6379"

# ============================================
# AUTHENTICATION (JWT)
# ============================================
# Generate with: openssl rand -base64 64
JWT_SECRET="your-super-secret-jwt-key-change-in-production"
JWT_ACCESS_EXPIRY="15m"
JWT_REFRESH_EXPIRY="7d"

# ============================================
# AI PROVIDERS
# ============================================
# Provider selection: mock | openai | openrouter
# Recommended for production: openrouter (cost-effective with free tier)
AI_PROVIDER="mock"

# --- OpenAI (Premium) ---
# Get from: https://platform.openai.com/api-keys
OPENAI_API_KEY=""

# --- OpenRouter (400+ models via single API) ---
# Get from: https://openrouter.ai/keys
# Free tier: 50 requests/day (1000/day with $10+ credits)
OPENROUTER_API_KEY=""

# OpenRouter Model Selection
# ┌──────────────────────────────────────────────────────────────┐
# │ RECOMMENDED MODELS BY TIER                                   │
# ├──────────────────────────────────────────────────────────────┤
# │ FREE ($0):                                                   │
# │   - google/gemini-2.0-flash-exp:free    (default, fast)      │
# │   - meta-llama/llama-3.3-70b-instruct:free  (large, smart)   │
# │   - deepseek/deepseek-chat:free         (good reasoning)     │
# │   - mistralai/mistral-7b-instruct:free  (fast, lightweight)  │
# │   - qwen/qwen-2.5-72b-instruct:free     (multilingual)       │
# │                                                              │
# │ LOW COST (~$0.0001-0.001/1K tokens):                         │
# │   - deepseek/deepseek-chat              (best value)         │
# │   - anthropic/claude-3-haiku            (fast, cheap)        │
# │   - meta-llama/llama-3.1-70b-instruct   (balanced)           │
# │                                                              │
# │ PREMIUM (higher quality/cost):                               │
# │   - anthropic/claude-3.5-sonnet         (best reasoning)     │
# │   - openai/gpt-4o                       (versatile)          │
# │   - google/gemini-1.5-pro               (multimodal)         │
# ├──────────────────────────────────────────────────────────────┤
# │ Full model list: https://openrouter.ai/models                │
# │ ANY valid OpenRouter model string works!                     │
# └──────────────────────────────────────────────────────────────┘
OPENROUTER_MODEL="google/gemini-2.0-flash-exp:free"

# ============================================
# SERVER
# ============================================
PORT="3000"
NODE_ENV="development"
LOG_LEVEL="info"

# ============================================
# RATE LIMITING
# ============================================
RATE_LIMIT_MAX="100"
RATE_LIMIT_WINDOW="1 minute"

# ============================================
# WHATSAPP WORKER
# ============================================
# Global message rate limit (per tenant)
WHATSAPP_MESSAGE_RATE_LIMIT="5"

# Per-customer rate limit
WHATSAPP_CUSTOMER_RATE_LIMIT="10"
WHATSAPP_CUSTOMER_RATE_WINDOW="60"

# ============================================
# FRONTEND (Vite Apps)
# ============================================
# Used in apps/web and apps/admin
VITE_API_URL="http://localhost:3000"

# ============================================
# STRIPE BILLING
# ============================================
# Get from: https://dashboard.stripe.com/apikeys
# Test mode keys start with sk_test_ and pk_test_
STRIPE_SECRET_KEY=""
STRIPE_PUBLISHABLE_KEY=""

# Webhook signing secret
# Get from: https://dashboard.stripe.com/webhooks → Your endpoint → Signing secret
# For local dev: Use Stripe CLI → stripe listen --forward-to localhost:3000/webhooks/stripe
STRIPE_WEBHOOK_SECRET=""

# Web app URL (for checkout redirects)
WEB_APP_URL="http://localhost:5173"
